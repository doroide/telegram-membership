<!DOCTYPE html>
<html>
<head>
    <title>Subscription Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container py-4">
    <h2 class="mb-4">üìä Subscription Dashboard</h2>

    <div class="d-flex justify-content-between mb-3">
        <input id="searchInput" type="text" class="form-control w-50" placeholder="Search user...">
        <a href="/admin/export_csv" class="btn btn-success">‚¨áÔ∏è Export CSV</a>
    </div>

    <table class="table table-bordered table-striped">
        <thead class="table-dark">
            <tr>
                <th>Telegram ID</th>
                <th>Username</th>
                <th>Plan</th>
                <th>Expiry</th>
                <th>Status</th>
            </tr>
        </thead>

        <tbody id="userTable">
            {% for u in users %}
            <tr>
                <td>{{ u.telegram_id }}</td>
                <td>{{ u.username }}</td>
                <td>{{ u.plan }}</td>
                <td>{{ u.expiry_date }}</td>
                <td>
                    {% if u.is_active %}
                        <span class="badge bg-success">ACTIVE</span>
                    {% else %}
                        <span class="badge bg-danger">EXPIRED</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    // Search function
    document.getElementById("searchInput").addEventListener("keyup", function () {
        let value = this.value.toLowerCase();
        let rows = document.querySelectorAll("#userTable tr");

        rows.forEach(row => {
            row.style.display = row.innerText.toLowerCase().includes(value) ? "" : "none";
        });
    });
</script>

</body>
</html>
